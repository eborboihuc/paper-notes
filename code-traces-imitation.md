![](https://cloud.githubusercontent.com/assets/7057863/18335789/b7e4f29a-75b4-11e6-9b13-182bf29b7822.png)

--

**Note**: It seems that [the code from authors](https://github.com/openai/imitation) switched the order of *step 4.* and *step 5.*

3: [Sample trajectories](https://github.com/openai/imitation/blob/master/policyopt/imitation.py#L438-L446)

5: [Update policy](https://github.com/openai/imitation/blob/master/policyopt/imitation.py#L476-L484) 

4: [Update discriminator](https://github.com/openai/imitation/blob/master/policyopt/imitation.py#L486-L498)
